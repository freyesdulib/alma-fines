"use strict";var fines={checkApis:function(){var e="https://"+document.domain+"/api/status/authorize",t="https://"+document.domain+"/api/status/alma",a=[e,t],n=new XMLHttpRequest;a.forEach(function(e){n.open("POST",e),n.onload=function(){200!==n.status&&($("form").hide(),$("#apiMessage").html("The Fines & Fees payment system is currently unavailable.  We're sorry for the inconvenience.   Please try again later."))},n.send(null)})},saveBalance:function(e){sessionStorage.removeItem("userBalance"),sessionStorage.setItem("userBalance",e)},disableButton:function(e,t){$("#"+e).click(function(){$(this).prop("disabled",!0),$(this).empty().append(t),$(this).parents("form").submit()})},pay:function(e,t,a){$("#"+e).click(function(){$(this).prop("disabled",!0),$("#cancel").hide(),$(this).empty().append("Processing Payment..."),$(this).parents("form").submit();var e=setInterval(function(){$.ajax({url:location.protocol+"//"+document.domain+":"+location.port+"/status?t="+t+"&uid="+a,type:"get",dataType:"json",cache:!1}).done(function(t){return 0!==t.length&&(1===t.status&&"Ok"==t.result_code?(clearInterval(e),$("#paymentForm").html('<div class="alert alert-success"><i class="fa fa-check-circle"></i> Payment was successful. Amount paid: ($'+t.amount_paid+")   One moment please...</div>"),setTimeout(function(){window.location=location.protocol+"//"+document.domain+":"+location.port+"/fines"+window.location.search},5e3),window.scrollTo(0,0),!1):1===t.status&&"Error"==t.result_code?(clearInterval(e),$("#paymentForm").html('<div class="alert alert-danger"><i class="fa fa-exclamation-triangle"></i> Payment failed.  One moment please...</div>'),setTimeout(function(){window.location=location.protocol+"//"+document.domain+":"+location.port+"/fines"+window.location.search},3e3),window.scrollTo(0,0),!1):void 0)}).fail(function(e,t){$("#paymentForm").html('<div class="alert alert-danger">Payment process failed.  We\'re sorry for the inconvenience.  One moment please...</div>'),setTimeout(function(){window.location=location.protocol+"//"+document.domain+":"+location.port+"/fines"+window.location.search},3e3)})},1e3)})},cancel:function(){$("#cancel").click(function(){$(this).prop("disabled",!0),$(this).empty().append("Cancelling...")})},getBalance:function(){return sessionStorage.getItem("userBalance")},calculateBalance:function(){$('input[type="checkbox"]').on("click",function(){var e,t,a,n=fines.getBalance(),o=parseFloat($(this).val()),i=$(this).is(":checked");if(n=JSON.parse(n),e=parseFloat(n.total),t=i?e+o:e-o,a={total:parseFloat(t).toFixed(2)},"0.00"===a.total){var s='<div class="alert alert-danger"><strong>You must select at least one fine to pay.</strong></div>';$("#payOnline").prop("disabled",!0),$("#message").css("color","red").html(s)}else $("#payOnline").prop("disabled",!1),$("#message").html("");fines.saveBalance(JSON.stringify(a)),$("#balance").html("$"+a.total),$("#fineTotal").val(a.total)})}};